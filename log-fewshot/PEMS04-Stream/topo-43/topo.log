2025-12-18 17:35:18,376 - logger name:log-fewshot/PEMS04-Stream/topo-43/topo.log
2025-12-18 17:35:18,376 - Params: {'conf': 'conf/PEMS4.json', 'seed': 43, 'paral': 0, 'gpuid': 0, 'logname': 'topo', 'method': 'TopoPrompt', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS3/topo-43/2011/14.7956.pkl', 'device': device(type='cuda', index=0), 'methods': {'TopoPrompt': <class 'src.models.model.TopoPrompt'>}, 'begin_year': 2011, 'end_year': 2017, 'dropout': 0.0, 'lr': 0.03, 'batch_size': 64, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 1, 'raw_data_path': '../autodl-tmp/data1/PEMS4/finaldata/', 'save_data_path': '../autodl-tmp/data1/PEMS4/FastData_fewshot/', 'graph_path': '../autodl-tmp/data1/PEMS4/graph/', 'model_path': 'log-fewshot/PEMS04-Stream', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'init': True, 'train': 1, 'auto_test': 1, 'strategy': 'retrain', 'path': 'log-fewshot/PEMS04-Stream/topo-43', 'logger': <Logger utils.initialize (INFO)>}
2025-12-18 17:35:18,698 - [*] Year 2011 loaded from ../autodl-tmp/data1/PEMS4/FastData_fewshot/2011.npz
2025-12-18 17:35:18,862 - [*] Year 2011 Dataset load!
2025-12-18 17:35:18,886 - Total Parameters: 9179
2025-12-18 17:35:18,886 - Trainable Parameters: 9179
2025-12-18 17:35:18,887 - [*] Year 2011 Training start
2025-12-18 17:35:19,660 - node number torch.Size([11520, 12])
2025-12-18 17:35:21,224 - epoch:0, training loss:1179.5516 validation loss:5.1783
2025-12-18 17:35:23,232 - epoch:1, training loss:32.6330 validation loss:3.7924
2025-12-18 17:35:25,273 - epoch:2, training loss:13.6653 validation loss:2.8196
2025-12-18 17:35:27,382 - epoch:3, training loss:9.9969 validation loss:2.8328
2025-12-18 17:35:29,517 - epoch:4, training loss:8.5966 validation loss:2.3755
2025-12-18 17:35:31,648 - epoch:5, training loss:7.8062 validation loss:2.5152
2025-12-18 17:35:33,721 - epoch:6, training loss:7.2871 validation loss:2.4077
2025-12-18 17:35:35,861 - epoch:7, training loss:7.0450 validation loss:2.1590
2025-12-18 17:35:37,944 - epoch:8, training loss:6.9406 validation loss:2.2949
2025-12-18 17:35:39,997 - epoch:9, training loss:6.8014 validation loss:2.2868
2025-12-18 17:35:42,177 - epoch:10, training loss:6.7908 validation loss:2.3502
2025-12-18 17:35:44,259 - epoch:11, training loss:6.9225 validation loss:2.1731
2025-12-18 17:35:46,369 - epoch:12, training loss:6.6814 validation loss:2.6816
2025-12-18 17:35:48,494 - epoch:13, training loss:6.8256 validation loss:2.2626
2025-12-18 17:35:49,513 - [*] loss:17.3868
2025-12-18 17:35:49,536 - [*] year 2011, testing
2025-12-18 17:35:49,642 - T:3	MAE	1.8303	RMSE	3.4855	MAPE	3.8702
2025-12-18 17:35:49,820 - T:6	MAE	1.9172	RMSE	3.7453	MAPE	4.0647
2025-12-18 17:35:50,535 - T:12	MAE	2.0696	RMSE	4.1957	MAPE	4.4108
2025-12-18 17:35:50,535 - T:Avg	MAE	1.9331	RMSE	3.7824	MAPE	4.1019
2025-12-18 17:35:50,535 - Finished optimization, total time:15.78 s, best model:log-fewshot/PEMS04-Stream/topo-43/2011/2.1590.pkl
2025-12-18 17:35:50,870 - [*] Year 2012 loaded from ../autodl-tmp/data1/PEMS4/FastData_fewshot/2012.npz
2025-12-18 17:35:50,872 - [*] Year 2012 Dataset load!
2025-12-18 17:35:50,872 - [*] load from log-fewshot/PEMS04-Stream/topo-43/2011/2.1590.pkl
2025-12-18 17:35:50,881 - [*] Year 2012 Training start
2025-12-18 17:35:52,088 - node number torch.Size([12672, 12])
2025-12-18 17:35:53,506 - epoch:0, training loss:87.5135 validation loss:3.1105
2025-12-18 17:35:55,974 - epoch:1, training loss:14.9162 validation loss:2.3091
2025-12-18 17:35:58,412 - epoch:2, training loss:10.5925 validation loss:1.9218
2025-12-18 17:36:00,813 - epoch:3, training loss:9.6600 validation loss:1.8229
2025-12-18 17:36:03,173 - epoch:4, training loss:9.3184 validation loss:1.7900
2025-12-18 17:36:05,685 - epoch:5, training loss:8.9081 validation loss:1.7840
2025-12-18 17:36:07,983 - epoch:6, training loss:8.6679 validation loss:1.7804
2025-12-18 17:36:10,341 - epoch:7, training loss:8.5218 validation loss:1.8022
2025-12-18 17:36:12,671 - epoch:8, training loss:8.4445 validation loss:1.7618
2025-12-18 17:36:14,998 - epoch:9, training loss:8.4278 validation loss:1.7711
2025-12-18 17:36:17,298 - epoch:10, training loss:8.3016 validation loss:1.7492
2025-12-18 17:36:19,769 - epoch:11, training loss:8.3688 validation loss:1.7965
2025-12-18 17:36:22,176 - epoch:12, training loss:8.1736 validation loss:1.7973
2025-12-18 17:36:24,540 - epoch:13, training loss:8.2431 validation loss:1.7781
2025-12-18 17:36:26,887 - epoch:14, training loss:8.1342 validation loss:1.7939
2025-12-18 17:36:29,214 - epoch:15, training loss:8.0868 validation loss:1.7863
2025-12-18 17:36:31,774 - epoch:16, training loss:8.1949 validation loss:1.8289
2025-12-18 17:36:32,963 - [*] loss:13.8428
2025-12-18 17:36:32,988 - [*] year 2012, testing
2025-12-18 17:36:33,107 - T:3	MAE	1.6070	RMSE	2.9862	MAPE	3.2469
2025-12-18 17:36:33,311 - T:6	MAE	1.7175	RMSE	3.3163	MAPE	3.4873
2025-12-18 17:36:33,857 - T:12	MAE	1.8738	RMSE	3.8268	MAPE	3.8422
2025-12-18 17:36:33,857 - T:Avg	MAE	1.7138	RMSE	3.3336	MAPE	3.4892
2025-12-18 17:36:33,858 - Finished optimization, total time:21.58 s, best model:log-fewshot/PEMS04-Stream/topo-43/2012/1.7492.pkl
2025-12-18 17:36:34,214 - [*] Year 2013 loaded from ../autodl-tmp/data1/PEMS4/FastData_fewshot/2013.npz
2025-12-18 17:36:34,216 - [*] Year 2013 Dataset load!
2025-12-18 17:36:34,216 - [*] load from log-fewshot/PEMS04-Stream/topo-43/2012/1.7492.pkl
2025-12-18 17:36:34,223 - [*] Year 2013 Training start
2025-12-18 17:36:35,371 - node number torch.Size([13632, 12])
2025-12-18 17:36:36,811 - epoch:0, training loss:107.8808 validation loss:4.7763
2025-12-18 17:36:39,266 - epoch:1, training loss:22.5683 validation loss:2.7928
2025-12-18 17:36:41,832 - epoch:2, training loss:16.4500 validation loss:2.5009
2025-12-18 17:36:44,256 - epoch:3, training loss:15.4340 validation loss:2.4368
2025-12-18 17:36:46,793 - epoch:4, training loss:14.9918 validation loss:2.3771
2025-12-18 17:36:49,273 - epoch:5, training loss:14.7997 validation loss:2.4428
2025-12-18 17:36:51,870 - epoch:6, training loss:14.5338 validation loss:2.4185
2025-12-18 17:36:54,596 - epoch:7, training loss:14.5143 validation loss:2.3391
2025-12-18 17:36:57,090 - epoch:8, training loss:14.3233 validation loss:2.2901
2025-12-18 17:36:59,663 - epoch:9, training loss:14.2760 validation loss:2.3584
2025-12-18 17:37:02,174 - epoch:10, training loss:14.1794 validation loss:2.3543
2025-12-18 17:37:04,771 - epoch:11, training loss:14.0601 validation loss:2.2610
2025-12-18 17:37:07,270 - epoch:12, training loss:13.9948 validation loss:2.2769
2025-12-18 17:37:09,772 - epoch:13, training loss:13.9871 validation loss:2.2551
2025-12-18 17:37:12,303 - epoch:14, training loss:13.9101 validation loss:2.2778
2025-12-18 17:37:14,708 - epoch:15, training loss:14.0102 validation loss:2.2735
2025-12-18 17:37:17,369 - epoch:16, training loss:14.3693 validation loss:2.3046
2025-12-18 17:37:20,000 - epoch:17, training loss:14.0579 validation loss:2.2778
2025-12-18 17:37:22,511 - epoch:18, training loss:13.8772 validation loss:2.3231
2025-12-18 17:37:25,013 - epoch:19, training loss:13.8654 validation loss:2.4010
2025-12-18 17:37:26,289 - [*] loss:16.1924
2025-12-18 17:37:26,326 - [*] year 2013, testing
2025-12-18 17:37:26,452 - T:3	MAE	1.7634	RMSE	3.0150	MAPE	3.6998
2025-12-18 17:37:26,675 - T:6	MAE	1.9445	RMSE	3.4729	MAPE	4.1092
2025-12-18 17:37:27,302 - T:12	MAE	2.2119	RMSE	4.1317	MAPE	4.7171
2025-12-18 17:37:27,302 - T:Avg	MAE	1.9513	RMSE	3.4866	MAPE	4.1306
2025-12-18 17:37:27,302 - Finished optimization, total time:26.41 s, best model:log-fewshot/PEMS04-Stream/topo-43/2013/2.2551.pkl
2025-12-18 17:37:27,710 - [*] Year 2014 loaded from ../autodl-tmp/data1/PEMS4/FastData_fewshot/2014.npz
2025-12-18 17:37:27,712 - [*] Year 2014 Dataset load!
2025-12-18 17:37:27,712 - [*] load from log-fewshot/PEMS04-Stream/topo-43/2013/2.2551.pkl
2025-12-18 17:37:27,719 - [*] Year 2014 Training start
2025-12-18 17:37:28,911 - node number torch.Size([14400, 12])
2025-12-18 17:37:30,369 - epoch:0, training loss:150.5424 validation loss:4.3219
2025-12-18 17:37:32,957 - epoch:1, training loss:25.9384 validation loss:2.6927
2025-12-18 17:37:35,501 - epoch:2, training loss:15.4259 validation loss:2.2447
2025-12-18 17:37:38,066 - epoch:3, training loss:14.2133 validation loss:2.2509
2025-12-18 17:37:40,530 - epoch:4, training loss:14.0014 validation loss:2.3024
2025-12-18 17:37:43,013 - epoch:5, training loss:13.9399 validation loss:2.3098
2025-12-18 17:37:45,467 - epoch:6, training loss:13.7421 validation loss:2.3704
2025-12-18 17:37:47,966 - epoch:7, training loss:13.6487 validation loss:2.2816
2025-12-18 17:37:50,435 - epoch:8, training loss:13.6588 validation loss:2.3105
2025-12-18 17:37:51,688 - [*] loss:15.3105
2025-12-18 17:37:51,718 - [*] year 2014, testing
2025-12-18 17:37:51,862 - T:3	MAE	1.5147	RMSE	2.5882	MAPE	2.8761
2025-12-18 17:37:52,097 - T:6	MAE	1.7239	RMSE	3.1640	MAPE	3.3197
2025-12-18 17:37:52,778 - T:12	MAE	1.9724	RMSE	3.9624	MAPE	3.8642
2025-12-18 17:37:52,778 - T:Avg	MAE	1.7242	RMSE	3.1763	MAPE	3.3185
2025-12-18 17:37:52,779 - Finished optimization, total time:11.76 s, best model:log-fewshot/PEMS04-Stream/topo-43/2014/2.2447.pkl
2025-12-18 17:37:53,195 - [*] Year 2015 loaded from ../autodl-tmp/data1/PEMS4/FastData_fewshot/2015.npz
2025-12-18 17:37:53,196 - [*] Year 2015 Dataset load!
2025-12-18 17:37:53,196 - [*] load from log-fewshot/PEMS04-Stream/topo-43/2014/2.2447.pkl
2025-12-18 17:37:53,204 - [*] Year 2015 Training start
2025-12-18 17:37:54,462 - node number torch.Size([15040, 12])
2025-12-18 17:37:55,989 - epoch:0, training loss:73.2627 validation loss:4.9618
2025-12-18 17:37:58,584 - epoch:1, training loss:16.4169 validation loss:2.4768
2025-12-18 17:38:01,166 - epoch:2, training loss:12.6326 validation loss:2.4393
2025-12-18 17:38:03,783 - epoch:3, training loss:12.0187 validation loss:2.2822
2025-12-18 17:38:06,308 - epoch:4, training loss:11.6620 validation loss:2.2795
2025-12-18 17:38:08,952 - epoch:5, training loss:11.4627 validation loss:2.3520
2025-12-18 17:38:11,583 - epoch:6, training loss:11.3479 validation loss:2.2764
2025-12-18 17:38:14,215 - epoch:7, training loss:11.3155 validation loss:2.2934
2025-12-18 17:38:16,806 - epoch:8, training loss:11.2042 validation loss:2.5391
2025-12-18 17:38:19,443 - epoch:9, training loss:11.0585 validation loss:2.3335
2025-12-18 17:38:22,024 - epoch:10, training loss:11.0308 validation loss:2.1325
2025-12-18 17:38:24,687 - epoch:11, training loss:11.0610 validation loss:2.2993
2025-12-18 17:38:27,269 - epoch:12, training loss:10.8451 validation loss:2.3242
2025-12-18 17:38:29,909 - epoch:13, training loss:10.8535 validation loss:2.3301
2025-12-18 17:38:32,581 - epoch:14, training loss:10.8761 validation loss:2.2777
2025-12-18 17:38:35,127 - epoch:15, training loss:10.9795 validation loss:2.3660
2025-12-18 17:38:37,623 - epoch:16, training loss:10.7730 validation loss:2.3962
2025-12-18 17:38:38,900 - [*] loss:16.7037
2025-12-18 17:38:38,939 - [*] year 2015, testing
2025-12-18 17:38:39,074 - T:3	MAE	1.6022	RMSE	2.7936	MAPE	3.2585
2025-12-18 17:38:39,313 - T:6	MAE	1.8125	RMSE	3.3815	MAPE	3.7343
2025-12-18 17:38:40,001 - T:12	MAE	2.1095	RMSE	4.2388	MAPE	4.4100
2025-12-18 17:38:40,001 - T:Avg	MAE	1.8187	RMSE	3.4004	MAPE	3.7495
2025-12-18 17:38:40,001 - Finished optimization, total time:22.76 s, best model:log-fewshot/PEMS04-Stream/topo-43/2015/2.1325.pkl
2025-12-18 17:38:40,408 - [*] Year 2016 loaded from ../autodl-tmp/data1/PEMS4/FastData_fewshot/2016.npz
2025-12-18 17:38:40,410 - [*] Year 2016 Dataset load!
2025-12-18 17:38:40,410 - [*] load from log-fewshot/PEMS04-Stream/topo-43/2015/2.1325.pkl
2025-12-18 17:38:40,416 - [*] Year 2016 Training start
2025-12-18 17:38:41,604 - node number torch.Size([15552, 12])
2025-12-18 17:38:43,278 - epoch:0, training loss:103.6610 validation loss:4.8741
2025-12-18 17:38:45,924 - epoch:1, training loss:16.2708 validation loss:3.2899
2025-12-18 17:38:48,695 - epoch:2, training loss:11.3907 validation loss:2.8572
2025-12-18 17:38:51,396 - epoch:3, training loss:10.0144 validation loss:2.7641
2025-12-18 17:38:54,124 - epoch:4, training loss:9.5915 validation loss:2.8512
2025-12-18 17:38:56,720 - epoch:5, training loss:9.5502 validation loss:2.7836
2025-12-18 17:38:59,274 - epoch:6, training loss:9.3962 validation loss:2.7599
2025-12-18 17:39:01,989 - epoch:7, training loss:9.3799 validation loss:2.7242
2025-12-18 17:39:04,675 - epoch:8, training loss:9.3222 validation loss:2.6727
2025-12-18 17:39:07,394 - epoch:9, training loss:9.2559 validation loss:2.5968
2025-12-18 17:39:09,999 - epoch:10, training loss:9.2635 validation loss:2.9696
2025-12-18 17:39:12,769 - epoch:11, training loss:9.2045 validation loss:2.6744
2025-12-18 17:39:15,458 - epoch:12, training loss:9.2796 validation loss:2.6980
2025-12-18 17:39:18,123 - epoch:13, training loss:9.2143 validation loss:2.7323
2025-12-18 17:39:20,736 - epoch:14, training loss:9.1974 validation loss:2.6473
2025-12-18 17:39:23,411 - epoch:15, training loss:9.1431 validation loss:2.8722
2025-12-18 17:39:24,694 - [*] loss:23.3898
2025-12-18 17:39:24,718 - [*] year 2016, testing
2025-12-18 17:39:24,901 - T:3	MAE	2.2069	RMSE	3.8175	MAPE	5.1212
2025-12-18 17:39:25,150 - T:6	MAE	2.4238	RMSE	4.3368	MAPE	5.6423
2025-12-18 17:39:25,868 - T:12	MAE	2.6415	RMSE	5.0104	MAPE	6.2186
2025-12-18 17:39:25,868 - T:Avg	MAE	2.3997	RMSE	4.3251	MAPE	5.6016
2025-12-18 17:39:25,868 - Finished optimization, total time:22.30 s, best model:log-fewshot/PEMS04-Stream/topo-43/2016/2.5968.pkl
2025-12-18 17:39:26,302 - [*] Year 2017 loaded from ../autodl-tmp/data1/PEMS4/FastData_fewshot/2017.npz
2025-12-18 17:39:26,304 - [*] Year 2017 Dataset load!
2025-12-18 17:39:26,304 - [*] load from log-fewshot/PEMS04-Stream/topo-43/2016/2.5968.pkl
2025-12-18 17:39:26,310 - [*] Year 2017 Training start
2025-12-18 17:39:27,659 - node number torch.Size([15872, 12])
2025-12-18 17:39:29,371 - epoch:0, training loss:103.0050 validation loss:7.1030
2025-12-18 17:39:32,083 - epoch:1, training loss:22.0068 validation loss:4.2891
2025-12-18 17:39:34,627 - epoch:2, training loss:14.0334 validation loss:3.1182
2025-12-18 17:39:37,281 - epoch:3, training loss:12.6950 validation loss:2.8980
2025-12-18 17:39:39,810 - epoch:4, training loss:11.9708 validation loss:2.9191
2025-12-18 17:39:42,430 - epoch:5, training loss:11.8399 validation loss:2.6635
2025-12-18 17:39:45,097 - epoch:6, training loss:11.7181 validation loss:2.8108
2025-12-18 17:39:47,692 - epoch:7, training loss:11.6373 validation loss:2.8220
2025-12-18 17:39:50,377 - epoch:8, training loss:11.3279 validation loss:3.0449
2025-12-18 17:39:53,075 - epoch:9, training loss:11.2285 validation loss:2.8493
2025-12-18 17:39:55,686 - epoch:10, training loss:11.1464 validation loss:2.7766
2025-12-18 17:39:58,410 - epoch:11, training loss:11.2034 validation loss:3.0009
2025-12-18 17:39:59,737 - [*] loss:22.1681
2025-12-18 17:39:59,764 - [*] year 2017, testing
2025-12-18 17:39:59,927 - T:3	MAE	2.0042	RMSE	3.7567	MAPE	4.5001
2025-12-18 17:40:00,179 - T:6	MAE	2.1781	RMSE	4.1908	MAPE	4.9005
2025-12-18 17:40:00,893 - T:12	MAE	2.4114	RMSE	4.8008	MAPE	5.4424
2025-12-18 17:40:00,894 - T:Avg	MAE	2.1797	RMSE	4.1986	MAPE	4.9071
2025-12-18 17:40:00,895 - Finished optimization, total time:16.68 s, best model:log-fewshot/PEMS04-Stream/topo-43/2017/2.6635.pkl
2025-12-18 17:40:00,896 - 

Evaluation Metrics Across Years:
2025-12-18 17:40:00,896 - 3   	MAE	      1.83	      1.61	      1.76	      1.51	      1.60	      2.21	      2.00		    1.79
2025-12-18 17:40:00,896 - 3   	RMSE	      3.49	      2.99	      3.02	      2.59	      2.79	      3.82	      3.76		    3.21
2025-12-18 17:40:00,896 - 3   	MAPE	      3.87	      3.25	      3.70	      2.88	      3.26	      5.12	      4.50		    3.80
2025-12-18 17:40:00,896 - 6   	MAE	      1.92	      1.72	      1.94	      1.72	      1.81	      2.42	      2.18		    1.96
2025-12-18 17:40:00,897 - 6   	RMSE	      3.75	      3.32	      3.47	      3.16	      3.38	      4.34	      4.19		    3.66
2025-12-18 17:40:00,897 - 6   	MAPE	      4.06	      3.49	      4.11	      3.32	      3.73	      5.64	      4.90		    4.18
2025-12-18 17:40:00,897 - 12  	MAE	      2.07	      1.87	      2.21	      1.97	      2.11	      2.64	      2.41		    2.18
2025-12-18 17:40:00,897 - 12  	RMSE	      4.20	      3.83	      4.13	      3.96	      4.24	      5.01	      4.80		    4.31
2025-12-18 17:40:00,897 - 12  	MAPE	      4.41	      3.84	      4.72	      3.86	      4.41	      6.22	      5.44		    4.70
2025-12-18 17:40:00,897 - Avg 	MAE	      1.93	      1.71	      1.95	      1.72	      1.82	      2.40	      2.18		    1.96
2025-12-18 17:40:00,897 - Avg 	RMSE	      3.78	      3.33	      3.49	      3.18	      3.40	      4.33	      4.20		    3.67
2025-12-18 17:40:00,897 - Avg 	MAPE	      4.10	      3.49	      4.13	      3.32	      3.75	      5.60	      4.91		    4.19
2025-12-18 17:40:00,897 - 
Training Time Statistics:
2025-12-18 17:40:00,897 - Year 2011 | Total Time:    15.7826s | Avg/Epoch:     1.1273s | Epochs: 14
2025-12-18 17:40:00,897 - Year 2012 | Total Time:    21.5816s | Avg/Epoch:     1.2695s | Epochs: 17
2025-12-18 17:40:00,897 - Year 2013 | Total Time:    26.4082s | Avg/Epoch:     1.3204s | Epochs: 20
2025-12-18 17:40:00,897 - Year 2014 | Total Time:    11.7648s | Avg/Epoch:     1.3072s | Epochs: 9
2025-12-18 17:40:00,897 - Year 2015 | Total Time:    22.7594s | Avg/Epoch:     1.3388s | Epochs: 17
2025-12-18 17:40:00,897 - Year 2016 | Total Time:    22.3008s | Avg/Epoch:     1.3938s | Epochs: 16
2025-12-18 17:40:00,897 - Year 2017 | Total Time:    16.6809s | Avg/Epoch:     1.3901s | Epochs: 12
2025-12-18 17:40:00,897 - Total training time across all years: 137.2782s
