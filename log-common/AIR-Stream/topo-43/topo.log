2025-12-17 23:15:15,219 - logger name:log-common/AIR-Stream/topo-43/topo.log
2025-12-17 23:15:15,219 - Params: {'conf': 'conf/AIR.json', 'seed': 43, 'paral': 0, 'gpuid': 0, 'logname': 'topo', 'method': 'TopoPrompt', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS3/topo-43/2011/14.7956.pkl', 'device': device(type='cuda', index=0), 'methods': {'TopoPrompt': <class 'src.models.model.TopoPrompt'>}, 'begin_year': 2016, 'end_year': 2019, 'dropout': 0.0, 'lr': 0.021, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'raw_data_path': '../autodl-tmp/data/AIR/RawData/', 'save_data_path': '../autodl-tmp/data/AIR/FastData/', 'graph_path': '../autodl-tmp/data/AIR/graph/', 'model_path': 'log-common/AIR-Stream', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'rank': 6, 'init': True, 'train': 1, 'auto_test': 1, 'strategy': 'retrain', 'path': 'log-common/AIR-Stream/topo-43', 'logger': <Logger utils.initialize (INFO)>}
2025-12-17 23:15:15,242 - [*] Year 2016 loaded from ../autodl-tmp/data/AIR/FastData/2016.npz
2025-12-17 23:15:17,083 - [*] Year 2016 Dataset load!
2025-12-17 23:15:17,086 - Total Parameters: 36389
2025-12-17 23:15:17,086 - Trainable Parameters: 36389
2025-12-17 23:15:17,086 - [*] Year 2016 Training start
2025-12-17 23:15:20,322 - node number torch.Size([139136, 12])
2025-12-17 23:15:25,792 - epoch:0, training loss:2949.9293 validation loss:30.0246
2025-12-17 23:15:33,479 - epoch:1, training loss:1474.4634 validation loss:23.0990
2025-12-17 23:15:41,195 - epoch:2, training loss:1213.7274 validation loss:21.1873
2025-12-17 23:15:48,794 - epoch:3, training loss:1159.1517 validation loss:20.2314
2025-12-17 23:15:56,802 - epoch:4, training loss:1121.1728 validation loss:18.3269
2025-12-17 23:16:04,695 - epoch:5, training loss:1093.7764 validation loss:19.3733
2025-12-17 23:16:12,519 - epoch:6, training loss:1065.7242 validation loss:23.1854
2025-12-17 23:16:20,089 - epoch:7, training loss:1062.6115 validation loss:19.9867
2025-12-17 23:16:27,884 - epoch:8, training loss:1032.6562 validation loss:19.7850
2025-12-17 23:16:35,509 - epoch:9, training loss:1039.6570 validation loss:19.0671
2025-12-17 23:16:43,201 - epoch:10, training loss:1024.5197 validation loss:18.2589
2025-12-17 23:16:51,189 - epoch:11, training loss:1004.5647 validation loss:19.4583
2025-12-17 23:16:58,982 - epoch:12, training loss:1024.1360 validation loss:17.3038
2025-12-17 23:17:07,004 - epoch:13, training loss:1032.0383 validation loss:22.3392
2025-12-17 23:17:14,924 - epoch:14, training loss:990.5522 validation loss:19.8857
2025-12-17 23:17:22,878 - epoch:15, training loss:977.4721 validation loss:17.6310
2025-12-17 23:17:30,807 - epoch:16, training loss:984.1035 validation loss:20.6645
2025-12-17 23:17:38,765 - epoch:17, training loss:945.8974 validation loss:18.9072
2025-12-17 23:17:46,595 - epoch:18, training loss:932.8141 validation loss:17.2865
2025-12-17 23:17:54,400 - epoch:19, training loss:935.9764 validation loss:19.6138
2025-12-17 23:18:02,211 - epoch:20, training loss:931.3943 validation loss:17.5177
2025-12-17 23:18:09,988 - epoch:21, training loss:945.4961 validation loss:21.2521
2025-12-17 23:18:17,806 - epoch:22, training loss:919.9571 validation loss:19.5713
2025-12-17 23:18:25,782 - epoch:23, training loss:913.1846 validation loss:18.9233
2025-12-17 23:18:33,685 - epoch:24, training loss:920.8898 validation loss:17.6041
2025-12-17 23:18:36,703 - [*] loss:2266.7197
2025-12-17 23:18:36,804 - [*] year 2016, testing
2025-12-17 23:18:37,650 - T:3	MAE	23.3745	RMSE	38.1110	MAPE	23.7948
2025-12-17 23:18:39,340 - T:6	MAE	26.1683	RMSE	42.8970	MAPE	27.3771
2025-12-17 23:18:45,316 - T:12	MAE	29.2964	RMSE	47.9236	MAPE	31.6952
2025-12-17 23:18:45,316 - T:Avg	MAE	25.9407	RMSE	42.3623	MAPE	27.1870
2025-12-17 23:18:45,330 - Finished optimization, total time:124.19 s, best model:log-common/AIR-Stream/topo-43/2016/17.2865.pkl
2025-12-17 23:18:45,489 - [*] Year 2017 loaded from ../autodl-tmp/data/AIR/FastData/2017.npz
2025-12-17 23:18:47,233 - [*] Year 2017 Dataset load!
2025-12-17 23:18:47,233 - [*] load from log-common/AIR-Stream/topo-43/2016/17.2865.pkl
2025-12-17 23:18:47,244 - [*] Year 2017 Training start
2025-12-17 23:18:50,290 - node number torch.Size([147712, 12])
2025-12-17 23:18:54,384 - epoch:0, training loss:1150.2813 validation loss:22.1301
2025-12-17 23:19:00,804 - epoch:1, training loss:1012.1716 validation loss:22.3773
2025-12-17 23:19:07,378 - epoch:2, training loss:972.4965 validation loss:22.9504
2025-12-17 23:19:13,967 - epoch:3, training loss:947.9786 validation loss:22.9120
2025-12-17 23:19:20,495 - epoch:4, training loss:935.3067 validation loss:21.8627
2025-12-17 23:19:26,999 - epoch:5, training loss:927.2941 validation loss:22.7365
2025-12-17 23:19:34,595 - epoch:6, training loss:926.7684 validation loss:21.5320
2025-12-17 23:19:41,099 - epoch:7, training loss:914.8990 validation loss:21.7971
2025-12-17 23:19:47,700 - epoch:8, training loss:901.6986 validation loss:21.8097
2025-12-17 23:19:54,296 - epoch:9, training loss:899.0250 validation loss:23.3971
2025-12-17 23:20:00,977 - epoch:10, training loss:897.3535 validation loss:21.8163
2025-12-17 23:20:07,606 - epoch:11, training loss:893.1451 validation loss:23.1581
2025-12-17 23:20:14,081 - epoch:12, training loss:890.9468 validation loss:21.6216
2025-12-17 23:20:17,383 - [*] loss:1483.2778
2025-12-17 23:20:17,499 - [*] year 2017, testing
2025-12-17 23:20:18,168 - T:3	MAE	18.3541	RMSE	27.5184	MAPE	22.4249
2025-12-17 23:20:19,838 - T:6	MAE	21.5551	RMSE	33.1821	MAPE	25.4912
2025-12-17 23:20:25,568 - T:12	MAE	24.9577	RMSE	38.7483	MAPE	29.1486
2025-12-17 23:20:25,569 - T:Avg	MAE	21.2492	RMSE	32.4600	MAPE	25.3290
2025-12-17 23:20:25,583 - Finished optimization, total time:45.82 s, best model:log-common/AIR-Stream/topo-43/2017/21.5320.pkl
2025-12-17 23:20:25,752 - [*] Year 2018 loaded from ../autodl-tmp/data/AIR/FastData/2018.npz
2025-12-17 23:20:27,512 - [*] Year 2018 Dataset load!
2025-12-17 23:20:27,512 - [*] load from log-common/AIR-Stream/topo-43/2017/21.5320.pkl
2025-12-17 23:20:27,519 - [*] Year 2018 Training start
2025-12-17 23:20:30,406 - node number torch.Size([152704, 12])
2025-12-17 23:20:34,072 - epoch:0, training loss:1017.5146 validation loss:22.2079
2025-12-17 23:20:40,409 - epoch:1, training loss:923.6646 validation loss:21.9654
2025-12-17 23:20:46,854 - epoch:2, training loss:903.6057 validation loss:25.0294
2025-12-17 23:20:53,692 - epoch:3, training loss:878.8381 validation loss:22.8224
2025-12-17 23:21:00,270 - epoch:4, training loss:870.4642 validation loss:23.1002
2025-12-17 23:21:07,075 - epoch:5, training loss:860.8597 validation loss:23.4476
2025-12-17 23:21:13,812 - epoch:6, training loss:844.2571 validation loss:22.0136
2025-12-17 23:21:20,378 - epoch:7, training loss:855.1398 validation loss:23.3967
2025-12-17 23:21:23,413 - [*] loss:1079.0581
2025-12-17 23:21:23,520 - [*] year 2018, testing
2025-12-17 23:21:24,256 - T:3	MAE	12.6558	RMSE	22.3432	MAPE	19.4274
2025-12-17 23:21:26,096 - T:6	MAE	15.8374	RMSE	27.6249	MAPE	24.9226
2025-12-17 23:21:31,872 - T:12	MAE	19.1880	RMSE	32.8989	MAPE	31.0610
2025-12-17 23:21:31,872 - T:Avg	MAE	15.5077	RMSE	26.9346	MAPE	24.4836
2025-12-17 23:21:31,889 - Finished optimization, total time:27.98 s, best model:log-common/AIR-Stream/topo-43/2018/21.9654.pkl
2025-12-17 23:21:32,065 - [*] Year 2019 loaded from ../autodl-tmp/data/AIR/FastData/2019.npz
2025-12-17 23:21:33,944 - [*] Year 2019 Dataset load!
2025-12-17 23:21:33,944 - [*] load from log-common/AIR-Stream/topo-43/2018/21.9654.pkl
2025-12-17 23:21:33,951 - [*] Year 2019 Training start
2025-12-17 23:21:36,889 - node number torch.Size([153856, 12])
2025-12-17 23:21:40,602 - epoch:0, training loss:769.5765 validation loss:19.2506
2025-12-17 23:21:47,167 - epoch:1, training loss:710.4151 validation loss:18.9744
2025-12-17 23:21:53,708 - epoch:2, training loss:685.8856 validation loss:18.7928
2025-12-17 23:22:00,393 - epoch:3, training loss:672.0883 validation loss:17.9998
2025-12-17 23:22:07,284 - epoch:4, training loss:664.8727 validation loss:18.5754
2025-12-17 23:22:13,991 - epoch:5, training loss:656.4816 validation loss:18.2824
2025-12-17 23:22:20,697 - epoch:6, training loss:649.4608 validation loss:17.9452
2025-12-17 23:22:27,563 - epoch:7, training loss:647.0105 validation loss:18.9145
2025-12-17 23:22:34,552 - epoch:8, training loss:645.9799 validation loss:17.6046
2025-12-17 23:22:41,502 - epoch:9, training loss:641.9644 validation loss:17.4725
2025-12-17 23:22:48,299 - epoch:10, training loss:644.9350 validation loss:18.0947
2025-12-17 23:22:55,157 - epoch:11, training loss:645.3368 validation loss:18.6296
2025-12-17 23:23:01,798 - epoch:12, training loss:635.6717 validation loss:18.1494
2025-12-17 23:23:08,583 - epoch:13, training loss:632.2664 validation loss:17.4948
2025-12-17 23:23:15,283 - epoch:14, training loss:629.5213 validation loss:17.8780
2025-12-17 23:23:22,270 - epoch:15, training loss:627.1554 validation loss:17.9538
2025-12-17 23:23:25,464 - [*] loss:1093.9833
2025-12-17 23:23:25,584 - [*] year 2019, testing
2025-12-17 23:23:26,297 - T:3	MAE	15.2885	RMSE	23.2804	MAPE	21.6696
2025-12-17 23:23:28,059 - T:6	MAE	18.1140	RMSE	28.3691	MAPE	25.1361
2025-12-17 23:23:33,640 - T:12	MAE	21.0377	RMSE	33.1825	MAPE	29.3951
2025-12-17 23:23:33,641 - T:Avg	MAE	17.8224	RMSE	27.6570	MAPE	24.9942
2025-12-17 23:23:33,655 - Finished optimization, total time:57.43 s, best model:log-common/AIR-Stream/topo-43/2019/17.4725.pkl
2025-12-17 23:23:33,810 - 

Evaluation Metrics Across Years:
2025-12-17 23:23:33,811 - 3   	MAE	     23.37	     18.35	     12.66	     15.29		   17.42
2025-12-17 23:23:33,811 - 3   	RMSE	     38.11	     27.52	     22.34	     23.28		   27.81
2025-12-17 23:23:33,811 - 3   	MAPE	     23.79	     22.42	     19.43	     21.67		   21.83
2025-12-17 23:23:33,811 - 6   	MAE	     26.17	     21.56	     15.84	     18.11		   20.42
2025-12-17 23:23:33,811 - 6   	RMSE	     42.90	     33.18	     27.62	     28.37		   33.02
2025-12-17 23:23:33,811 - 6   	MAPE	     27.38	     25.49	     24.92	     25.14		   25.73
2025-12-17 23:23:33,811 - 12  	MAE	     29.30	     24.96	     19.19	     21.04		   23.62
2025-12-17 23:23:33,811 - 12  	RMSE	     47.92	     38.75	     32.90	     33.18		   38.19
2025-12-17 23:23:33,811 - 12  	MAPE	     31.70	     29.15	     31.06	     29.40		   30.32
2025-12-17 23:23:33,811 - Avg 	MAE	     25.94	     21.25	     15.51	     17.82		   20.13
2025-12-17 23:23:33,811 - Avg 	RMSE	     42.36	     32.46	     26.93	     27.66		   32.35
2025-12-17 23:23:33,811 - Avg 	MAPE	     27.19	     25.33	     24.48	     24.99		   25.50
2025-12-17 23:23:33,811 - 
Training Time Statistics:
2025-12-17 23:23:33,811 - Year 2016 | Total Time:   124.1902s | Avg/Epoch:     4.9676s | Epochs: 25
2025-12-17 23:23:33,811 - Year 2017 | Total Time:    45.8167s | Avg/Epoch:     3.5244s | Epochs: 13
2025-12-17 23:23:33,811 - Year 2018 | Total Time:    27.9763s | Avg/Epoch:     3.4970s | Epochs: 8
2025-12-17 23:23:33,811 - Year 2019 | Total Time:    57.4308s | Avg/Epoch:     3.5894s | Epochs: 16
2025-12-17 23:23:33,811 - Total training time across all years: 255.4140s
